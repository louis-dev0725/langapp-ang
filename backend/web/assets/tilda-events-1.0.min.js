window.Tilda=window.Tilda||{},function(y){Tilda.sendEcommerceEvent=function(e,t){if(void 0===t||0==t.length)return!1;if(void 0===e||"add"!=e&&"remove"!=e&&"purchase"!=e&&"detail"!=e)return!1;for(var i,r,a,d="",c=0,o=[],n="",m="",l="",p=0;p<t.length;p++){""<d&&(d+=", "),d+=(a=t[p]).name,c+=a.price,r="",void 0!==a.options&&0<a.options.length&&y.each(a.options,function(e,t){r+=t.option+": "+t.variant+"; "});var s={name:a.name,price:a.price,variant:r,quantity:1};a.id&&0<a.id&&(id=a.id,s.id=a.id),a.uid&&0<a.uid&&(m=a.uid,s.uid=a.uid),a.recid&&0<a.recid&&(n=a.recid,s.recid=a.recid),a.lid&&0<a.lid&&(l=a.lid,s.lid=a.lid),a.sku&&0<a.sku&&(s.sku=a.sku),o[o.length]=s}"add"!=e&&"remove"!=e||(i="/tilda/cart/"+e+"/",0<n&&(i+=""+n),0<m?i+="-u"+m:0<l&&(i+="-"+l)),"detail"==e&&(i="/tilda/product/detail/",0<m?i+=m+"/":(0<n&&(i+="r"+n),0<l&&(i+="-l"+l))),"purchase"==e&&(i="/tilda/rec"+n+"/payment/"),(s={ecommerce:{}}).ecommerce[e]={products:o},Tilda.sendEventToStatistics(i,d,s,c)},Tilda.sendEventToStatistics=function(e,t,i,r){var a,d,c="/"==e.substring(0,1),o=[],n=0,m=!(!(m=y("#allrecords").data("fb-event"))||"nosend"!=m),l=!(!(l=y("#allrecords").data("vk-event"))||"nosend"!=l),p=y("#allrecords").data("tilda-currency")||y(".t706").data("project-currency-code")||"RUB";if(i=i||window.location.href,0<(r=r?parseFloat(r):0))if(window.dataLayer||(window.dataLayer=[]),-1!=e.indexOf("/tilda/")&&-1!=e.indexOf("/payment/")&&window.tildaForm&&""<window.tildaForm.orderIdForStat)i={ecommerce:{purchase:{actionField:{id:window.tildaForm.orderIdForStat,revenue:window.tildaForm.amountForStat},products:window.tildaForm.arProductsForStat}}},window.tildaForm.tildapayment&&window.tildaForm.tildapayment.promocode&&(i.ecommerce.purchase.actionField.coupon=window.tildaForm.tildapayment.promocode),i.event="purchase";else if(i&&i.ecommerce&&(i.ecommerce.add&&i.ecommerce.add.products?o=i.ecommerce.add.products:i.ecommerce.remove&&i.ecommerce.remove.products?o=i.ecommerce.remove.products:i.ecommerce.detail&&i.ecommerce.detail.products&&(o=i.ecommerce.detail.products),o&&0<o.length)){for(n=0;n<o.length;n++)o[n].id||(o[n].sku?o[n].id=o[n].sku:o[n].uid?o[n].id=o[n].uid:o[n].recid&&o[n].lid&&(o[n].id=o[n].recid+"_"+o[n].lid));i.ecommerce.add&&i.ecommerce.add.products?(i.ecommerce.add.products=o,i.event="addToCart"):i.ecommerce.remove&&i.ecommerce.remove.products?(i.ecommerce.remove.products=o,i.event="removeFromCart"):i.ecommerce.detail&&i.ecommerce.detail.products?(i.ecommerce.detail.products=o,i.event="viewProduct"):(c?(i.event="pageView",i.eventAction=e):i.event=e,i.title=t,i.value=r)}null!=window.dataLayer&&(c?0<r?i&&i.ecommerce?window.dataLayer.push(i):window.dataLayer.push({event:"pageView",eventAction:e,title:t,value:r,product:i}):window.dataLayer.push({event:"pageView",eventAction:e,title:t,referer:i}):i&&i.ecommerce?window.dataLayer.push(i):window.dataLayer.push({event:e,eventAction:t,value:r,referer:i}));try{window.gtagTrackerID&&"gtag"==window.mainTracker&&(c?i&&i.event?"purchase"==i.event?gtag("event","purchase",{transaction_id:i.ecommerce.purchase.actionField.id,value:parseFloat(r).toFixed(2),currency:p,items:i.ecommerce.purchase.products}):"addToCart"==i.event&&i.ecommerce.add?gtag("event","add_to_cart",{items:i.ecommerce.add.products}):"removeFromCart"==i.event&&i.ecommerce.remove?gtag("event","remove_from_cart",{items:i.ecommerce.remove.products}):"viewProduct"==i.event&&i.ecommerce.detail&&gtag("event","view_item",{items:i.ecommerce.detail.products}):gtag("config",window.gtagTrackerID,{page_title:t,page_path:e}):gtag("event",e,{event_category:"tilda",event_label:t,value:r}))}catch(e){}if(window.ga&&"tilda"!=window.mainTracker&&"gtag"!=window.mainTracker)if(c)if(i&&i.event){try{if(window.Tilda.isLoadGAEcommerce||(window.Tilda.isLoadGAEcommerce=!0,ga("require","ec")),ga("set","currencyCode",p),"purchase"==i.event){var s=i.ecommerce.purchase.products.length;for(g=0;g<s;g++)h=i.ecommerce.purchase.products[g],ga("ec:addProduct",{id:h.id||g,name:h.name,price:parseFloat(h.price).toFixed(2),quantity:h.quantity});ga("ec:setAction","purchase",{id:i.ecommerce.purchase.actionField.id,revenue:parseFloat(r).toFixed(2)})}else if("addToCart"==i.event&&i.ecommerce.add){s=i.ecommerce.add.products.length;for(g=0;g<s;g++)h=i.ecommerce.add.products[g],ga("ec:addProduct",{id:h.id||g,name:h.name,price:parseFloat(h.price).toFixed(2),quantity:h.quantity});ga("ec:setAction","add")}else if("removeFromCart"==i.event&&i.ecommerce.remove){s=i.ecommerce.remove.products.length;for(g=0;g<s;g++)h=i.ecommerce.remove.products[g],ga("ec:addProduct",{id:h.id||g,name:h.name,price:parseFloat(h.price).toFixed(2),quantity:h.quantity});ga("ec:setAction","remove")}else if("viewProduct"==i.event&&i.ecommerce.detail){s=i.ecommerce.detail.products.length;for(g=0;g<s;g++)h=i.ecommerce.detail.products[g],ga("ec:addProduct",{id:h.id||g,name:h.name,price:parseFloat(h.price).toFixed(2),quantity:h.quantity});ga("ec:setAction","detail")}}catch(e){}ga("send",{hitType:"pageview",page:e,title:t,params:i})}else ga("send",{hitType:"pageview",page:e,title:t});else ga("send",{hitType:"event",eventCategory:"tilda",eventAction:e,eventLabel:t,eventValue:r});if(window.mainMetrikaId&&0<window.mainMetrikaId&&"function"==typeof ym&&(c?(a={title:t},0<r&&(a.params={order_price:r},p&&(a.params.currency=p)),ym(window.mainMetrikaId,"hit",e,a)):0<r?(a={order_price:r},p&&(a.currency=p),ym(window.mainMetrikaId,"reachGoal",e,a)):ym(window.mainMetrikaId,"reachGoal",e)),""<window.mainMetrika&&window[window.mainMetrika]&&(c?0<r?window[window.mainMetrika].hit(e,{title:t,order_price:r,params:i}):window[window.mainMetrika].hit(e,{title:t}):0<r?window[window.mainMetrika].reachGoal(e,{title:t,params:i,order_price:r}):window[window.mainMetrika].reachGoal(e,{title:t,referer:i})),null!=window.fbq&&0==m)try{if(c)if(-1==e.indexOf("tilda/")||-1==e.indexOf("/payment/")&&-1==e.indexOf("/submitted/"))if(i&&i.event&&0<r)if("addToCart"==i.event&&i.ecommerce.add){var s=i.ecommerce.add.products.length,u=[];for(g=0;g<s;g++)h=i.ecommerce.add.products[g],u.push(h.id||h.uid||h.name);window.fbq("track","AddToCart",{content_ids:u,content_type:"product",value:r,currency:p})}else if("viewProduct"==i.event&&i.ecommerce.detail){s=i.ecommerce.detail.products.length,u=[];for(g=0;g<s;g++)h=i.ecommerce.detail.products[g],u.push(h.id||h.uid||h.name);window.fbq("track","ViewContent",{content_ids:u,content_type:"product",value:r,currency:p})}else e.indexOf("tilda/popup"),window.fbq("track","ViewContent",{content_name:t,content_category:e});else e.indexOf("tilda/popup"),window.fbq("track","ViewContent",{content_name:t,content_category:e});else 0<r&&p?window.fbq("track","InitiateCheckout",{content_name:t,content_category:e,value:r,currency:p}):window.fbq("track","Lead",{content_name:t,content_category:e});else window.fbq("track",e,{content_name:t,value:r})}catch(e){}if(void 0!==window.VK&&void 0!==window.VK.Retargeting&&0==l)try{if(c){var w=y("#allrecords").data("vk-price-list-id")?parseInt(y("#allrecords").data("vk-price-list-id")):0,v="",f=!1;if(i&&i.event)if(f={products:[],currency_code:"",total_price:0},"purchase"==i.event&&i.ecommerce.purchase)if(0<r&&0<w){f.currency_code=p;s=i.ecommerce.purchase.products.length,u=[];for(g=0;g<s;g++)h=i.ecommerce.purchase.products[g],f.products.push({id:h.id||h.uid||h.name,price:h.price?h.price:0}),f.total_price=r;v="init_checkout"}else v="t-purchase";else if("addToCart"==i.event&&i.ecommerce.add)if(0<r&&0<w){f.currency_code=p;s=i.ecommerce.add.products.length,u=[];for(g=0;g<s;g++)h=i.ecommerce.add.products[g],f.products.push({id:h.id||h.uid||h.name,price:h.price?h.price:0}),f.total_price=r;v="add_to_cart"}else v="t-add-to-cart",i.ecommerce.add[0]&&i.ecommerce.add[0].uid&&(v+="-"+i.ecommerce.add[0].uid);else if("viewProduct"==i.event&&i.ecommerce.detail)if(0<r&&0<w){f.currency_code=p;s=i.ecommerce.detail.products.length,u=[];for(g=0;g<s;g++)h=i.ecommerce.detail.products[g],f.products.push({id:h.id||h.uid||h.name,price:h.price?h.price:0}),f.total_price=r;v="view_product"}else v="t-view-product",i.ecommerce.detail[0]&&i.ecommerce.detail[0].uid&&(v+="-"+i.ecommerce.detail[0].uid);else if("removeFromCart"==i.event&&i.ecommerce.remmove)if(0<r&&0<w){f.currency_code=p;var h,g,s=i.ecommerce.remove.products.length,u=[];for(g=0;g<s;g++)h=i.ecommerce.remove.products[g],f.products.push({id:h.id||h.uid||h.name,price:h.price?h.price:0}),f.total_price=r;v="remove_from_cart"}else v="t-remove-product",i.ecommerce.remove[0]&&i.ecommerce.remove[0].uid&&(v+="-"+i.ecommerce.remove[0].uid);else v=i.event;else v=-1!=e.indexOf("tilda/")&&-1!=e.indexOf("/payment/")?"t-purchase-"+e.replace("tilda/","").replace("/payment/",""):-1!=e.indexOf("tilda/")&&-1!=e.indexOf("/submitted/")?"t-lead-"+e.replace("tilda/","").replace("/submitted/",""):-1!=e.indexOf("tilda/popup")||-1!=e.indexOf("tilda/click")?"t-"+e.replace("tilda/","").replace("/","-"):"t-"+e.replace("/","-");0<w&&f&&f.currency_code?(VK.Retargeting.Event("purchase"),VK.Retargeting.ProductEvent(w,v,f)):VK.Retargeting.Event(v)}else VK.Retargeting.Event(e)}catch(e){}"0"<window.mainMailruId&&(d=window._tmr||(window._tmr=[]),c?0<r?d.push({id:""+window.mainMailruId,type:"pageView",url:e,value:r,start:(new Date).getTime()}):d.push({id:""+window.mainMailruId,type:"pageView",url:e,start:(new Date).getTime()}):0<r?d.push({id:""+window.mainMailruId,type:"reachGoal",goal:e,value:r}):d.push({id:""+window.mainMailruId,type:"reachGoal",goal:e})),"function"==typeof window.tildastat&&(c?(0<e.indexOf("payment")&&-1<e.indexOf("tilda/form")&&(e=e.replace("tilda/form","tilda/rec")),window.tildastat("pageview",{page:e})):window.tildastat("pageview",{page:"/tilda/event/"+e}))},Tilda.saveUTM=function(){try{var e=window.location.href,t="",i="";if(-1!==e.toLowerCase().indexOf("utm_")&&"string"==typeof(t=(t=(e=e.toLowerCase()).split("?"))[1])){var r,a,d=t.split("&");for(r in d)"utm_"==d[r].split("=")[0].substring(0,4)&&(i=i+d[r]+"|||");0<i.length&&((a=new Date).setDate(a.getDate()+30),document.cookie="TILDAUTM="+encodeURIComponent(i)+"; path=/; expires="+a.toUTCString())}}catch(e){}},y(document).ready(function(){var e=navigator.userAgent.toLowerCase(),t=-1!=e.indexOf("msie")&&parseInt(e.split("msie")[1]);8!=t&&9!=t||y(".t-btn").each(function(){var e=y(this).attr("href");0<y(this).find("table").length&&""<e&&-1==e.indexOf("#popup:")&&-1==e.indexOf("#price:")&&y(this).click(function(e){e.preventDefault();var t=y(this).attr("href");window.location.href=t})});try{1==y("#allrecords").length&&"no"==y("#allrecords").data("tilda-cookie")||Tilda.saveUTM()}catch(e){}y(".r").off("click","a.js-click-stat"),y(".r").on("click","a.js-click-stat",function(e){var t=y(this).data("tilda-event-name"),i=y(this).text(),a=y(this).attr("href")||"",d=y(this).attr("target"),t=t||"/tilda/click/".$(this).closest(".r").attr("id")+"/?url="+a;if(Tilda.sendEventToStatistics(t,i),"http"==a.substring(0,4))return window.setTimeout(function(){var e,t,i="",r="";if("_blank"==d){if(-1!=a.indexOf("?")&&(a=(i=a.split("?"))[0],-1!=(i=i[1]).indexOf("#")&&(i=i.split("#"),a=a+"#"+i[1],i=i[0]),i=i.split("&")),0==y("#tildaredirectform").length?y("body").append('<form id="tildaredirectform" target="_blank" method="GET" action="'+a+'" style="display:none;"></form>'):y("#tildaredirectform").attr("method","GET").attr("action",a),r="",0<i.length)for(e in i)(t=i[e].split("="))&&0<t.length&&(r+='<input type="hidden" name="'+t[0]+'" value="'+(t[1]?t[1]:"")+'">');y("#tildaredirectform").html(r),y("#tildaredirectform").submit()}else window.location.href=a},300),e.preventDefault(),!1}),y("input.js-amount").each(function(){var e=(e=y(this).val()).replace(/,/g,".");e=parseFloat(e.replace(/[^0-9\.]/g,"")),y(this).val(e)})})}(jQuery);